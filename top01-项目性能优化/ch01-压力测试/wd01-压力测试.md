# 压力测试



# 1、什么是压力测试



压力测试（Stress Testing）是软件开发和系统运维领域中的一种测试方法，旨在通过模拟实际使用情况下的高负载情况，评估系统在各种极端条件下的性能、稳定性和可靠性。这种测试可以帮助发现系统在承受高负载时可能出现的问题，如性能瓶颈、资源耗尽、内存泄漏等。

压力测试通常会模拟以下情况：

1. **并发用户：** 在短时间内模拟大量并发用户访问系统，以测试系统在高并发情况下的性能表现。
2. **大数据量：** 输入大量数据，例如数据库中的记录，来评估系统在处理大数据量时的性能。
3. **高负载：** 模拟高负载情况，例如大量请求或事务，以验证系统在高负载下是否能够保持稳定。
4. **长时间运行：** 在较长时间内运行测试，以便观察系统是否存在资源泄漏或性能逐渐下降的问题。



#2、什么时候需要压测

一般而言，只有在系统基础功能测试验证完成、系统趋于稳定的情况下，系统上线前，才会进行压测。在系统即将上线之前，进行压力测试可以验证系统在真实使用情况下的性能表现，确保系统能够在用户量增加时保持稳定。



#3、压测的目的是什么

评估系统在各种负载条件下的性能、稳定性和可靠性。通过模拟实际使用情况下的高负载场景，压测可以帮助发现系统可能存在的问题、瓶颈以及性能限制，从而提前采取措施进行优化和改进。



#4、压测性能指标



在进行压力测试时，通常会关注一系列性能指标，以评估系统在不同负载下的性能表现。以下是一些常见的压测性能指标：

1. **响应时间（Response Time）：** 用户发起请求后，系统返回响应的时间。这是衡量系统反应速度的重要指标，通常以平均响应时间、最大响应时间等方式表示。

2. **吞吐量（Throughput）：** 单位时间内系统能够处理的请求数量，反映系统的处理能力和效率。

3. **并发用户数（Concurrent Users）：** 同一时刻内正在使用系统的用户数量。通过增加并发用户数来测试系统在高负载下的性能。

4. **错误率（Error Rate）：** 在压力测试中发生错误的请求占总请求数的比例，用于评估系统在高负载下的稳定性。

5. **资源利用率（Resource Utilization）：** 包括CPU使用率、内存使用率、磁盘读写速度等资源的使用情况。这些指标可以帮助发现系统资源瓶颈。

6. **事务成功率（Transaction Success Rate）：** 执行成功的事务数占总事务数的比例。适用于需要多个步骤的操作，如在线购物流程。

7. **网络延迟（Network Latency）：** 请求从客户端到服务器和从服务器到客户端之间的网络传输时间。网络延迟可能影响系统的响应时间。

8. **系统负载（System Load）：** 系统的负载情况，包括CPU负载、内存使用情况等。高负载可能导致系统性能下降。

9. **数据库性能指标：** 包括数据库的查询响应时间、事务处理速度、连接数等。数据库性能是许多系统性能的关键因素之一。

10. **用户会话保持能力（Session Persistence）：** 测试系统在高负载下是否能够正确地保持用户会话状态，以确保用户体验的连贯性。



下面是主要的四种性能指标【响应时间、并发用户数、吞吐量、资源使用率】它们之间存在一定的相关性，共同反映出性能的不同方面。



![image-20230808102345184](wd01-%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95.assets/image-20230808102345184-16914614275321.png)



![image-20230808102431755](wd01-%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95.assets/image-20230808102431755-16914614737142.png)

1. **响应时间和并发用户数：** 响应时间是指用户发起请求到系统返回响应的时间。当并发用户数增加时，系统的负载增加，可能导致响应时间延长。高并发用户数会导致竞争系统资源，可能引发性能瓶颈。优化响应时间可以缩短用户等待时间，提高用户体验。
2. **并发用户数和吞吐量：** 并发用户数是指同一时刻内使用系统的用户数量，而吞吐量是单位时间内系统处理的请求数量。增加并发用户数可能会导致吞吐量上升，但当系统资源达到极限时，吞吐量可能达到饱和点。在资源有限的情况下，适度增加并发用户数可以提高吞吐量，但过多的并发用户可能会导致性能下降。
3. **吞吐量和响应时间：** 吞吐量与响应时间之间存在一定的权衡关系。增加吞吐量可能会导致响应时间增长，因为系统需要处理更多的请求。但过度追求高吞吐量可能会牺牲响应时间，降低用户体验。
4. **资源使用率和性能：** 资源使用率（如CPU、内存）是系统性能的关键因素。当资源利用率接近或超过极限时，系统可能会变得不稳定，导致响应时间延长或系统崩溃。优化资源使用率可以提高系统的性能和稳定性。



# 5、常用的压测工具

有许多压测工具可以用来模拟高负载条件并评估系统的性能。以下是一些常用的压测工具：

- **Apache JMeter：** JMeter 是一个开源的 Java 应用，用于执行功能和性能测试。它支持多种协议，如HTTP、HTTPS、FTP、SOAP、JDBC等，可以创建复杂的测试场景和脚本。

- **ab：** ab是apache自带的压力测试工具。ab非常实用，它不仅可以对apache服务器进行网站访问压力测试，也可以对或其它类型的服务器进行压力测试。比如nginx、tomcat、IIS等。

- **Locust：** Locust 是一个 Python 编写的开源压测工具，可以用代码方式定义测试场景。它具有可扩展性和分布式测试的能力。

- **Vegeta：** Vegeta 是一个命令行工具，专注于 HTTP 压力测试。它支持并发请求和定制化的请求负载。

- **Tsung：** Tsung 是一个基于 Erlang 的分布式压测工具，支持多种协议和场景，适用于大规模并发测试。

- **Artillery：** Artillery 是一个用于测试 HTTP、WebSocket 和 Socket.io 应用的开源工具，它支持通过代码方式定义测试场景。

- **Loader.io：** Loader.io 是一个基于云的压测服务，可以轻松创建和运行测试场景，提供即时结果和报告。

- **BlazeMeter：** BlazeMeter 是一个云端压测平台，支持多种协议和场景，提供可视化报告和分析。

- **k6：** k6 是一个现代的开源压测工具，使用 JavaScript 进行脚本编写，支持分布式测试和实时结果。

- **Wrk：** Wrk 是一个命令行 HTTP 压测工具，重点关注高性能场景，可以通过脚本定义测试流程。

- **MeterSphere** ：国内持续测试的开源平台。



